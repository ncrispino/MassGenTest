<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="2" failures="17" skipped="56" tests="622" time="15.741" timestamp="2025-12-23T16:50:14.143817+03:00" hostname="MBP.local"><testcase classname="massgen.tests.memory.test_context_window_management" name="test_with_persistent_memory" time="0.000"><error message="failed on setup with &quot;file /Users/admin/src/MassGen/massgen/tests/memory/test_context_window_management.py, line 45&#10;  async def test_with_persistent_memory(config: dict):&#10;      &quot;&quot;&quot;Test context compression with persistent memory enabled.&quot;&quot;&quot;&#10;      # Check if memory is enabled in config&#10;      memory_config = config.get(&quot;memory&quot;, {})&#10;      if not memory_config.get(&quot;enabled&quot;, True):&#10;          print(&quot;\n⚠️  Skipping: memory.enabled is false in config&quot;)&#10;          return&#10;&#10;      persistent_enabled = memory_config.get(&quot;persistent_memory&quot;, {}).get(&quot;enabled&quot;, True)&#10;      if not persistent_enabled:&#10;          print(&quot;\n⚠️  Skipping: memory.persistent_memory.enabled is false in config&quot;)&#10;          return&#10;&#10;      print(&quot;\n&quot; + &quot;=&quot; * 70)&#10;      print(&quot;TEST 1: Context Window Management WITH Persistent Memory&quot;)&#10;      print(&quot;=&quot; * 70 + &quot;\n&quot;)&#10;&#10;      # Get memory settings from config&#10;      persistent_config = memory_config.get(&quot;persistent_memory&quot;, {})&#10;      agent_name = persistent_config.get(&quot;agent_name&quot;, &quot;storyteller_agent&quot;)&#10;      session_name = persistent_config.get(&quot;session_name&quot;, &quot;test_session&quot;)&#10;      on_disk = persistent_config.get(&quot;on_disk&quot;, True)&#10;&#10;      # Create LLM backend for both agent and memory&#10;      llm_backend = ChatCompletionsBackend(&#10;          type=&quot;openai&quot;,&#10;          model=&quot;gpt-4o-mini&quot;,  # Use smaller model for faster testing&#10;          api_key=os.getenv(&quot;OPENAI_API_KEY&quot;),&#10;      )&#10;&#10;      # Create embedding backend for persistent memory&#10;      embedding_backend = ChatCompletionsBackend(&#10;          type=&quot;openai&quot;,&#10;          model=&quot;text-embedding-3-small&quot;,&#10;          api_key=os.getenv(&quot;OPENAI_API_KEY&quot;),&#10;      )&#10;&#10;      # Initialize memory systems&#10;      conversation_memory = ConversationMemory()&#10;      persistent_memory = PersistentMemory(&#10;          agent_name=agent_name,&#10;          session_name=session_name,&#10;          llm_backend=llm_backend,&#10;          embedding_backend=embedding_backend,&#10;          on_disk=on_disk,&#10;      )&#10;&#10;      # Create agent with memory&#10;      agent = SingleAgent(&#10;          backend=llm_backend,&#10;          agent_id=&quot;storyteller&quot;,&#10;          system_message=&quot;You are a creative storyteller. Create detailed, &quot; &quot;immersive narratives with rich descriptions.&quot;,&#10;          conversation_memory=conversation_memory,&#10;          persistent_memory=persistent_memory,&#10;      )&#10;&#10;      print(&quot;✅ Agent initialized with memory&quot;)&#10;      print(&quot;   - ConversationMemory: Active&quot;)&#10;      print(f&quot;   - PersistentMemory: Active (agent={agent_name}, session={session_name}, on_disk={on_disk})&quot;)&#10;      print(&quot;   - Model context window: 128,000 tokens&quot;)&#10;      print(&quot;   - Compression triggers at: 96,000 tokens (75%)&quot;)&#10;      print(&quot;   - Target after compression: 51,200 tokens (40%)\n&quot;)&#10;&#10;      # Simulate a conversation that will fill context&#10;      # Each turn will add significant tokens&#10;      story_prompts = [&#10;          &quot;Tell me the beginning of a space exploration story. Include details about the ship, crew, and their mission. (Make it 400+ words)&quot;,&#10;          &quot;What happens when they encounter their first alien planet? Describe it in vivid detail.&quot;,&#10;          &quot;Describe a tense first contact situation with aliens. What do they look like? How do they communicate?&quot;,&#10;          &quot;The mission takes an unexpected turn. What crisis occurs and how does the crew respond?&quot;,&#10;          &quot;Show me a dramatic action sequence involving the ship's technology and the alien environment.&quot;,&#10;          &quot;Reveal a plot twist about one of the crew members or the mission itself.&quot;,&#10;          &quot;Continue the story with escalating tension and more discoveries.&quot;,&#10;          &quot;How do cultural differences between humans and aliens create conflicts?&quot;,&#10;          &quot;Describe a major decision point for the crew captain. What are the stakes?&quot;,&#10;          &quot;Bring the story to a climactic moment with high drama.&quot;,&#10;      ]&#10;&#10;      turn = 0&#10;      for prompt in story_prompts:&#10;          turn += 1&#10;          print(f&quot;\n--- Turn {turn} ---&quot;)&#10;          print(f&quot;User: {prompt}\n&quot;)&#10;&#10;          response_text = &quot;&quot;&#10;          async for chunk in agent.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: prompt}]):&#10;              if chunk.type == &quot;content&quot; and chunk.content:&#10;                  response_text += chunk.content&#10;&#10;          print(f&quot;Agent: {response_text[:200]}...&quot;)&#10;          print(f&quot;       [{len(response_text)} chars in response]&quot;)&#10;&#10;          # Check if compression occurred by examining conversation size&#10;          if conversation_memory:&#10;              size = await conversation_memory.size()&#10;              print(f&quot;       [Conversation memory: {size} messages]\n&quot;)&#10;&#10;      print(&quot;\n✅ Test completed!&quot;)&#10;      print(&quot;   Check the output above for compression logs:&quot;)&#10;      print(&quot;   - Look for: '#x1F4CA Context usage: ...'&quot;)&#10;      print(&quot;   - Look for: '#x1F4E6 Compressed N messages into long-term memory'&quot;)&#10;E       fixture 'config' not found&#10;&gt;       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, subtests, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id&#10;&gt;       use 'pytest --fixtures [testpath]' for help on them.&#10;&#10;/Users/admin/src/MassGen/massgen/tests/memory/test_context_window_management.py:45&quot;">file /Users/admin/src/MassGen/massgen/tests/memory/test_context_window_management.py, line 45
  async def test_with_persistent_memory(config: dict):
      """Test context compression with persistent memory enabled."""
      # Check if memory is enabled in config
      memory_config = config.get("memory", {})
      if not memory_config.get("enabled", True):
          print("\n⚠️  Skipping: memory.enabled is false in config")
          return

      persistent_enabled = memory_config.get("persistent_memory", {}).get("enabled", True)
      if not persistent_enabled:
          print("\n⚠️  Skipping: memory.persistent_memory.enabled is false in config")
          return

      print("\n" + "=" * 70)
      print("TEST 1: Context Window Management WITH Persistent Memory")
      print("=" * 70 + "\n")

      # Get memory settings from config
      persistent_config = memory_config.get("persistent_memory", {})
      agent_name = persistent_config.get("agent_name", "storyteller_agent")
      session_name = persistent_config.get("session_name", "test_session")
      on_disk = persistent_config.get("on_disk", True)

      # Create LLM backend for both agent and memory
      llm_backend = ChatCompletionsBackend(
          type="openai",
          model="gpt-4o-mini",  # Use smaller model for faster testing
          api_key=os.getenv("OPENAI_API_KEY"),
      )

      # Create embedding backend for persistent memory
      embedding_backend = ChatCompletionsBackend(
          type="openai",
          model="text-embedding-3-small",
          api_key=os.getenv("OPENAI_API_KEY"),
      )

      # Initialize memory systems
      conversation_memory = ConversationMemory()
      persistent_memory = PersistentMemory(
          agent_name=agent_name,
          session_name=session_name,
          llm_backend=llm_backend,
          embedding_backend=embedding_backend,
          on_disk=on_disk,
      )

      # Create agent with memory
      agent = SingleAgent(
          backend=llm_backend,
          agent_id="storyteller",
          system_message="You are a creative storyteller. Create detailed, " "immersive narratives with rich descriptions.",
          conversation_memory=conversation_memory,
          persistent_memory=persistent_memory,
      )

      print("✅ Agent initialized with memory")
      print("   - ConversationMemory: Active")
      print(f"   - PersistentMemory: Active (agent={agent_name}, session={session_name}, on_disk={on_disk})")
      print("   - Model context window: 128,000 tokens")
      print("   - Compression triggers at: 96,000 tokens (75%)")
      print("   - Target after compression: 51,200 tokens (40%)\n")

      # Simulate a conversation that will fill context
      # Each turn will add significant tokens
      story_prompts = [
          "Tell me the beginning of a space exploration story. Include details about the ship, crew, and their mission. (Make it 400+ words)",
          "What happens when they encounter their first alien planet? Describe it in vivid detail.",
          "Describe a tense first contact situation with aliens. What do they look like? How do they communicate?",
          "The mission takes an unexpected turn. What crisis occurs and how does the crew respond?",
          "Show me a dramatic action sequence involving the ship's technology and the alien environment.",
          "Reveal a plot twist about one of the crew members or the mission itself.",
          "Continue the story with escalating tension and more discoveries.",
          "How do cultural differences between humans and aliens create conflicts?",
          "Describe a major decision point for the crew captain. What are the stakes?",
          "Bring the story to a climactic moment with high drama.",
      ]

      turn = 0
      for prompt in story_prompts:
          turn += 1
          print(f"\n--- Turn {turn} ---")
          print(f"User: {prompt}\n")

          response_text = ""
          async for chunk in agent.chat([{"role": "user", "content": prompt}]):
              if chunk.type == "content" and chunk.content:
                  response_text += chunk.content

          print(f"Agent: {response_text[:200]}...")
          print(f"       [{len(response_text)} chars in response]")

          # Check if compression occurred by examining conversation size
          if conversation_memory:
              size = await conversation_memory.size()
              print(f"       [Conversation memory: {size} messages]\n")

      print("\n✅ Test completed!")
      print("   Check the output above for compression logs:")
      print("   - Look for: '#x1F4CA Context usage: ...'")
      print("   - Look for: '#x1F4E6 Compressed N messages into long-term memory'")
E       fixture 'config' not found
&gt;       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, subtests, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id
&gt;       use 'pytest --fixtures [testpath]' for help on them.

/Users/admin/src/MassGen/massgen/tests/memory/test_context_window_management.py:45</error></testcase><testcase classname="massgen.tests.memory.test_context_window_management" name="test_without_persistent_memory" time="0.000"><error message="failed on setup with &quot;file /Users/admin/src/MassGen/massgen/tests/memory/test_context_window_management.py, line 148&#10;  async def test_without_persistent_memory(config: dict):&#10;      &quot;&quot;&quot;Test context compression without persistent memory (warning case).&quot;&quot;&quot;&#10;      # Check if we should run this test&#10;      memory_config = config.get(&quot;memory&quot;, {})&#10;      persistent_enabled = memory_config.get(&quot;persistent_memory&quot;, {}).get(&quot;enabled&quot;, True)&#10;&#10;      if persistent_enabled:&#10;          # Skip if persistent memory is enabled - we already tested that scenario&#10;          print(&quot;\n⚠️  Skipping Test 2: persistent memory is enabled in config&quot;)&#10;          print(&quot;   To test without persistent memory, set memory.persistent_memory.enabled: false&quot;)&#10;          return&#10;&#10;      print(&quot;\n&quot; + &quot;=&quot; * 70)&#10;      print(&quot;TEST 2: Context Window Management WITHOUT Persistent Memory&quot;)&#10;      print(&quot;=&quot; * 70 + &quot;\n&quot;)&#10;&#10;      # Create LLM backend&#10;      llm_backend = ChatCompletionsBackend(&#10;          type=&quot;openai&quot;,&#10;          model=&quot;gpt-4o-mini&quot;,&#10;          api_key=os.getenv(&quot;OPENAI_API_KEY&quot;),&#10;      )&#10;&#10;      # Only conversation memory, NO persistent memory&#10;      conversation_memory = ConversationMemory()&#10;&#10;      # Create agent without persistent memory&#10;      agent = SingleAgent(&#10;          backend=llm_backend,&#10;          agent_id=&quot;storyteller_no_persist&quot;,&#10;          system_message=&quot;You are a creative storyteller.&quot;,&#10;          conversation_memory=conversation_memory,&#10;          persistent_memory=None,  # No persistent memory!&#10;      )&#10;&#10;      print(&quot;⚠️  Agent initialized WITHOUT persistent memory&quot;)&#10;      print(&quot;   - ConversationMemory: Active&quot;)&#10;      print(&quot;   - PersistentMemory: NONE&quot;)&#10;      print(&quot;   - This will trigger warning messages when context fills\n&quot;)&#10;&#10;      # Shorter test - just trigger compression&#10;      story_prompts = [&#10;          &quot;Tell me a 500-word science fiction story about time travel.&quot;,&#10;          &quot;Continue the story with 500 more words about paradoxes.&quot;,&#10;          &quot;Add another 500 words with a plot twist.&quot;,&#10;          &quot;Continue with 500 words about the resolution.&quot;,&#10;          &quot;Write a 500-word epilogue.&quot;,&#10;      ]&#10;&#10;      turn = 0&#10;      for prompt in story_prompts:&#10;          turn += 1&#10;          print(f&quot;\n--- Turn {turn} ---&quot;)&#10;          print(f&quot;User: {prompt}\n&quot;)&#10;&#10;          response_text = &quot;&quot;&#10;          async for chunk in agent.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: prompt}]):&#10;              if chunk.type == &quot;content&quot; and chunk.content:&#10;                  response_text += chunk.content&#10;&#10;          print(f&quot;Agent: {response_text[:150]}...&quot;)&#10;&#10;      print(&quot;\n✅ Test completed!&quot;)&#10;      print(&quot;   Check the output above for warning messages:&quot;)&#10;      print(&quot;   - Look for: '⚠️  Warning: Dropping N messages'&quot;)&#10;      print(&quot;   - Look for: 'No persistent memory configured'&quot;)&#10;E       fixture 'config' not found&#10;&gt;       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, subtests, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id&#10;&gt;       use 'pytest --fixtures [testpath]' for help on them.&#10;&#10;/Users/admin/src/MassGen/massgen/tests/memory/test_context_window_management.py:148&quot;">file /Users/admin/src/MassGen/massgen/tests/memory/test_context_window_management.py, line 148
  async def test_without_persistent_memory(config: dict):
      """Test context compression without persistent memory (warning case)."""
      # Check if we should run this test
      memory_config = config.get("memory", {})
      persistent_enabled = memory_config.get("persistent_memory", {}).get("enabled", True)

      if persistent_enabled:
          # Skip if persistent memory is enabled - we already tested that scenario
          print("\n⚠️  Skipping Test 2: persistent memory is enabled in config")
          print("   To test without persistent memory, set memory.persistent_memory.enabled: false")
          return

      print("\n" + "=" * 70)
      print("TEST 2: Context Window Management WITHOUT Persistent Memory")
      print("=" * 70 + "\n")

      # Create LLM backend
      llm_backend = ChatCompletionsBackend(
          type="openai",
          model="gpt-4o-mini",
          api_key=os.getenv("OPENAI_API_KEY"),
      )

      # Only conversation memory, NO persistent memory
      conversation_memory = ConversationMemory()

      # Create agent without persistent memory
      agent = SingleAgent(
          backend=llm_backend,
          agent_id="storyteller_no_persist",
          system_message="You are a creative storyteller.",
          conversation_memory=conversation_memory,
          persistent_memory=None,  # No persistent memory!
      )

      print("⚠️  Agent initialized WITHOUT persistent memory")
      print("   - ConversationMemory: Active")
      print("   - PersistentMemory: NONE")
      print("   - This will trigger warning messages when context fills\n")

      # Shorter test - just trigger compression
      story_prompts = [
          "Tell me a 500-word science fiction story about time travel.",
          "Continue the story with 500 more words about paradoxes.",
          "Add another 500 words with a plot twist.",
          "Continue with 500 words about the resolution.",
          "Write a 500-word epilogue.",
      ]

      turn = 0
      for prompt in story_prompts:
          turn += 1
          print(f"\n--- Turn {turn} ---")
          print(f"User: {prompt}\n")

          response_text = ""
          async for chunk in agent.chat([{"role": "user", "content": prompt}]):
              if chunk.type == "content" and chunk.content:
                  response_text += chunk.content

          print(f"Agent: {response_text[:150]}...")

      print("\n✅ Test completed!")
      print("   Check the output above for warning messages:")
      print("   - Look for: '⚠️  Warning: Dropping N messages'")
      print("   - Look for: 'No persistent memory configured'")
E       fixture 'config' not found
&gt;       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, subtests, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id
&gt;       use 'pytest --fixtures [testpath]' for help on them.

/Users/admin/src/MassGen/massgen/tests/memory/test_context_window_management.py:148</error></testcase><testcase classname="massgen.tests.test_ag2_lesson_planner.TestAG2LessonPlannerTool" name="test_basic_lesson_plan_creation" time="0.001"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_ag2_lesson_planner.py:32: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_ag2_lesson_planner.TestAG2LessonPlannerTool" name="test_lesson_plan_with_env_api_key" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_ag2_lesson_planner.py:52: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_ag2_lesson_planner.TestAG2LessonPlannerTool" name="test_missing_api_key_error" time="0.000"><skipped type="pytest.xfail" message="Tool API drift: test expects topic/api_key kwargs but current tool interface differs; update test or add compatibility wrapper (.cursor/triage/tasks/cluster_e19eb78221.md)" /></testcase><testcase classname="massgen.tests.test_ag2_lesson_planner.TestAG2LessonPlannerTool" name="test_different_topics" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_ag2_lesson_planner.py:88: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_ag2_lesson_planner.TestAG2LessonPlannerTool" name="test_concurrent_lesson_plan_creation" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_ag2_lesson_planner.py:107: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_ag2_lesson_planner.TestAG2ToolIntegration" name="test_tool_function_signature" time="0.000"><failure message="AssertionError: assert False&#10; +  where False = &lt;function iscoroutinefunction at 0x109344720&gt;(ag2_lesson_planner)&#10; +    where &lt;function iscoroutinefunction at 0x109344720&gt; = &lt;module 'inspect' from '/opt/homebrew/Cellar/python@3.13/3.13.11/Frameworks/Python.framework/Versions/3.13/lib/python3.13/inspect.py'&gt;.iscoroutinefunction">self = &lt;massgen.tests.test_ag2_lesson_planner.TestAG2ToolIntegration object at 0x1225ec550&gt;

    def test_tool_function_signature(self):
        """Test that the tool has the correct async signature."""
        import inspect
    
&gt;       assert inspect.iscoroutinefunction(ag2_lesson_planner)
E       AssertionError: assert False
E        +  where False = &lt;function iscoroutinefunction at 0x109344720&gt;(ag2_lesson_planner)
E        +    where &lt;function iscoroutinefunction at 0x109344720&gt; = &lt;module 'inspect' from '/opt/homebrew/Cellar/python@3.13/3.13.11/Frameworks/Python.framework/Versions/3.13/lib/python3.13/inspect.py'&gt;.iscoroutinefunction

massgen/tests/test_ag2_lesson_planner.py:134: AssertionError</failure></testcase><testcase classname="massgen.tests.test_ag2_lesson_planner.TestAG2ToolIntegration" name="test_execution_result_structure" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_ag2_lesson_planner.py:153: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_ag2_lesson_planner.TestAG2ToolWithBackend" name="test_backend_registration" time="0.002" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentConversationMemory" name="test_agent_with_conversation_memory_initialization" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentConversationMemory" name="test_agent_adds_messages_to_conversation_memory" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentConversationMemory" name="test_agent_clears_conversation_memory_on_reset" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentConversationMemory" name="test_agent_clears_memory_on_clear_history" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentPersistentMemory" name="test_agent_with_persistent_memory_initialization" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentPersistentMemory" name="test_agent_retrieves_from_persistent_memory" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentPersistentMemory" name="test_agent_records_to_persistent_memory" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentPersistentMemory" name="test_agent_handles_memory_not_implemented_gracefully" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentBothMemories" name="test_agent_with_both_memories" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestSingleAgentBothMemories" name="test_memory_integration_flow" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestConfigurableAgentMemory" name="test_configurable_agent_with_memory" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestMemoryStateManagement" name="test_conversation_memory_survives_across_chats" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestMemoryStateManagement" name="test_reset_chat_clears_conversation_memory" time="0.002" /><testcase classname="massgen.tests.test_agent_memory.TestMemoryErrorHandling" name="test_agent_continues_when_memory_add_fails" time="0.001" /><testcase classname="massgen.tests.test_agent_memory.TestMemoryErrorHandling" name="test_agent_without_memory_works_normally" time="0.001" /><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_init_with_env_vars" time="0.000"><skipped type="pytest.xfail" message="Backend API drift: AzureOpenAIBackend missing azure_endpoint attribute expected by tests (.cursor/triage/tasks/cluster_4bbc1204e7.md)" /></testcase><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_init_with_kwargs" time="0.000"><skipped type="pytest.xfail" message="Backend API drift: AzureOpenAIBackend missing azure_endpoint attribute expected by tests (.cursor/triage/tasks/cluster_4bbc1204e7.md)" /></testcase><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_init_missing_api_key" time="0.000" /><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_init_missing_endpoint" time="0.000"><failure message="Failed: DID NOT RAISE &lt;class 'ValueError'&gt;">self = &lt;massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend object at 0x1225bec40&gt;

    def test_init_missing_endpoint(self):
        """Test initialization fails without endpoint."""
        with patch.dict(os.environ, {"AZURE_OPENAI_API_KEY": "test-key"}, clear=True):
&gt;           with pytest.raises(ValueError, match="Azure OpenAI endpoint URL is required"):
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E           Failed: DID NOT RAISE &lt;class 'ValueError'&gt;

massgen/tests/test_azure_openai_backend.py:52: Failed</failure></testcase><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_init_missing_api_key_with_endpoint" time="0.000" /><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_base_url_normalization" time="0.000"><skipped type="pytest.xfail" message="Backend API drift: AzureOpenAIBackend missing azure_endpoint attribute expected by tests (.cursor/triage/tasks/cluster_4bbc1204e7.md)" /></testcase><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_get_provider_name" time="0.000" /><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_estimate_tokens" time="0.005" /><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_calculate_cost" time="0.192" /><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_stream_with_tools_missing_model" time="0.007" /><testcase classname="massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend" name="test_stream_with_tools_with_model" time="0.001"><failure message="AttributeError: &lt;massgen.backend.azure_openai.AzureOpenAIBackend object at 0x123c7c910&gt; does not have the attribute 'client'">self = &lt;massgen.tests.test_azure_openai_backend.TestAzureOpenAIBackend object at 0x122644410&gt;

    @pytest.mark.asyncio
    async def test_stream_with_tools_with_model(self):
        """Test stream_with_tools works with model parameter."""
        backend = AzureOpenAIBackend(api_key="test-key", base_url="https://test.openai.azure.com/")
    
        messages = [{"role": "user", "content": "Hello"}]
        tools = []
    
        # Mock the client and create a mock stream response
        mock_chunk = MagicMock()
        mock_chunk.choices = [MagicMock()]
        mock_chunk.choices[0].delta = MagicMock()
        mock_chunk.choices[0].delta.content = "Hello"
        mock_chunk.choices[0].finish_reason = "stop"
    
        mock_stream = [mock_chunk]
    
&gt;       with patch.object(backend, "client") as mock_client:
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

massgen/tests/test_azure_openai_backend.py:142: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/homebrew/Cellar/python@3.13/3.13.11/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;unittest.mock._patch object at 0x123a63ce0&gt;

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
&gt;           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: &lt;massgen.backend.azure_openai.AzureOpenAIBackend object at 0x123c7c910&gt; does not have the attribute 'client'

/opt/homebrew/Cellar/python@3.13/3.13.11/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1467: AttributeError</failure></testcase><testcase classname="massgen.tests.test_backend_capabilities.TestBackendCapabilitiesRegistry" name="test_all_backends_have_required_fields" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendCapabilitiesRegistry" name="test_default_model_in_models_list" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendCapabilitiesRegistry" name="test_filesystem_support_values" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendCapabilitiesRegistry" name="test_no_empty_backend_types" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendCapabilitiesRegistry" name="test_capability_strings_are_valid" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestCapabilityQueries" name="test_get_capabilities_existing_backend" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestCapabilityQueries" name="test_get_capabilities_nonexistent_backend" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestCapabilityQueries" name="test_has_capability_true" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestCapabilityQueries" name="test_has_capability_false" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestCapabilityQueries" name="test_has_capability_nonexistent_backend" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestCapabilityQueries" name="test_get_all_backend_types" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestCapabilityQueries" name="test_get_backends_with_capability" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendValidation" name="test_validate_valid_openai_config" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendValidation" name="test_validate_invalid_capability" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendValidation" name="test_validate_invalid_backend_type" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendValidation" name="test_validate_code_execution_variants" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestBackendValidation" name="test_validate_mcp_servers" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestSpecificBackends" name="test_openai_capabilities" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestSpecificBackends" name="test_claude_capabilities" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestSpecificBackends" name="test_claude_code_capabilities" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestSpecificBackends" name="test_gemini_capabilities" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestSpecificBackends" name="test_local_backends_no_api_key" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestConsistency" name="test_filesystem_native_implies_capability" time="0.000" /><testcase classname="massgen.tests.test_backend_capabilities.TestConsistency" name="test_mcp_capability_consistency" time="0.000" /><testcase classname="massgen.tests.test_backend_cost_tracking" name="test_chat_completions_backend_usage_tracking" time="0.000"><skipped type="pytest.skip" message="integration test (enable with --run-integration or RUN_INTEGRATION=1)">/Users/admin/src/MassGen/massgen/tests/test_backend_cost_tracking.py:17: integration test (enable with --run-integration or RUN_INTEGRATION=1)</skipped></testcase><testcase classname="massgen.tests.test_backend_cost_tracking" name="test_claude_code_backend_usage_tracking" time="0.000"><skipped type="pytest.skip" message="integration test (enable with --run-integration or RUN_INTEGRATION=1)">/Users/admin/src/MassGen/massgen/tests/test_backend_cost_tracking.py:59: integration test (enable with --run-integration or RUN_INTEGRATION=1)</skipped></testcase><testcase classname="massgen.tests.test_backend_cost_tracking" name="test_o3_mini_reasoning_tokens_e2e" time="0.000"><skipped type="pytest.skip" message="integration test (enable with --run-integration or RUN_INTEGRATION=1)">/Users/admin/src/MassGen/massgen/tests/test_backend_cost_tracking.py:96: integration test (enable with --run-integration or RUN_INTEGRATION=1)</skipped></testcase><testcase classname="massgen.tests.test_backend_cost_tracking" name="test_claude_caching_e2e" time="0.000"><skipped type="pytest.skip" message="integration test (enable with --run-integration or RUN_INTEGRATION=1)">/Users/admin/src/MassGen/massgen/tests/test_backend_cost_tracking.py:136: integration test (enable with --run-integration or RUN_INTEGRATION=1)</skipped></testcase><testcase classname="massgen.tests.test_backend_event_loop_all" name="test_response_backend_stream_closes_client" time="0.001" /><testcase classname="massgen.tests.test_backend_event_loop_all" name="test_grok_backend_stream_closes_client" time="0.001" /><testcase classname="massgen.tests.test_backend_event_loop_all" name="test_claude_backend_stream_closes_client" time="0.001" /><testcase classname="massgen.tests.test_background_shell" name="test_start_simple_command" time="0.514" /><testcase classname="massgen.tests.test_background_shell" name="test_capture_stdout" time="0.522" /><testcase classname="massgen.tests.test_background_shell" name="test_capture_stderr" time="0.519" /><testcase classname="massgen.tests.test_background_shell" name="test_long_running_command" time="0.514" /><testcase classname="massgen.tests.test_background_shell" name="test_failed_command" time="0.519" /><testcase classname="massgen.tests.test_background_shell" name="test_multiple_concurrent_shells" time="2.030" /><testcase classname="massgen.tests.test_background_shell" name="test_convenience_functions" time="0.518" /><testcase classname="massgen.tests.test_background_shell" name="test_convenience_kill_function" time="0.523" /><testcase classname="massgen.tests.test_background_shell" name="test_nonexistent_shell" time="0.001" /><testcase classname="massgen.tests.test_background_shell" name="test_kill_already_stopped" time="0.516" /><testcase classname="massgen.tests.test_background_shell" name="test_max_concurrent_limit" time="1.031" /><testcase classname="massgen.tests.test_background_shell" name="test_ring_buffer_overflow" time="0.520" /><testcase classname="massgen.tests.test_background_shell" name="test_command_with_cwd" time="0.516" /><testcase classname="massgen.tests.test_background_shell" name="test_command_with_env" time="0.523" /><testcase classname="massgen.tests.test_background_shell" name="test_duration_tracking" time="0.722" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_read_image_with_read_tool" time="0.002" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_read_text_file_image" time="0.001" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_read_video" time="0.001" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_read_audio" time="0.001" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_allow_read_text_file" time="0.001" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_allow_read_code_file" time="0.001" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_all_image_formats" time="0.000" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_all_video_formats" time="0.001" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_all_audio_formats" time="0.001" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_archive_formats" time="0.000" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_executable_formats" time="0.000" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_old_office_formats" time="0.000" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_block_office_formats" time="0.000" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_case_insensitive_extension_check" time="0.000" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_non_text_read_tools_not_affected" time="0.001" /><testcase classname="massgen.tests.test_binary_file_blocking.TestBinaryFileBlocking" name="test_helpful_error_messages" time="0.000" /><testcase classname="massgen.tests.test_chat_completions_refactor" name="test_openai_backend" time="0.001"><skipped type="pytest.xfail" message="Backend API drift: ChatCompletionsBackend missing base_url attribute expected by tests (.cursor/triage/tasks/cluster_f6383dd4cb.md)" /></testcase><testcase classname="massgen.tests.test_chat_completions_refactor" name="test_together_ai_backend" time="0.000"><skipped type="pytest.xfail" message="Backend API drift: ChatCompletionsBackend missing base_url attribute expected by tests (.cursor/triage/tasks/cluster_f6383dd4cb.md)" /></testcase><testcase classname="massgen.tests.test_chat_completions_refactor" name="test_cerebras_backend" time="0.000"><skipped type="pytest.xfail" message="Backend API drift: ChatCompletionsBackend missing base_url attribute expected by tests (.cursor/triage/tasks/cluster_f6383dd4cb.md)" /></testcase><testcase classname="massgen.tests.test_chat_completions_refactor" name="test_tool_conversion" time="0.000"><failure message="AttributeError: 'ChatCompletionsBackend' object has no attribute 'convert_tools_to_chat_completions_format'">async def test_tool_conversion():
        """Test tool format conversion."""
        print("\n#x1F527 Testing tool format conversion...")
    
        backend = ChatCompletionsBackend()
    
        # Test Response API format conversion
        response_tools = [
            {
                "type": "function",
                "name": "get_weather",
                "description": "Get weather information",
                "parameters": {
                    "type": "object",
                    "properties": {"location": {"type": "string"}},
                    "required": ["location"],
                },
            },
        ]
    
&gt;       converted = backend.convert_tools_to_chat_completions_format(response_tools)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'ChatCompletionsBackend' object has no attribute 'convert_tools_to_chat_completions_format'

massgen/tests/test_chat_completions_refactor.py:88: AttributeError</failure></testcase><testcase classname="massgen.tests.test_claude_backend" name="test_claude_basic_streaming" time="0.020" /><testcase classname="massgen.tests.test_claude_backend" name="test_claude_tool_calling" time="0.005" /><testcase classname="massgen.tests.test_claude_backend" name="test_claude_multi_tool_support" time="0.004" /><testcase classname="massgen.tests.test_claude_backend" name="test_claude_message_conversion" time="0.001"><failure message="AttributeError: 'ClaudeBackend' object has no attribute 'convert_messages_to_claude_format'">async def test_claude_message_conversion():
        """Test Claude's message format conversion capabilities."""
        print("\n#x1F9EA Testing Claude Message Conversion...")
    
        backend = ClaudeBackend()
    
        # Test with tool result message (Chat Completions format)
        messages = [
            {"role": "user", "content": "What's 5 + 3?"},
            {
                "role": "assistant",
                "content": "Let me calculate that.",
                "tool_calls": [
                    {
                        "id": "call_123",
                        "type": "function",
                        "function": {"name": "add", "arguments": {"a": 5, "b": 3}},
                    },
                ],
            },
            {"role": "tool", "tool_call_id": "call_123", "content": "8"},
        ]
    
        # Convert messages
&gt;       converted, system_msg = backend.convert_messages_to_claude_format(messages)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'ClaudeBackend' object has no attribute 'convert_messages_to_claude_format'

massgen/tests/test_claude_backend.py:188: AttributeError</failure></testcase><testcase classname="massgen.tests.test_claude_backend" name="test_claude_error_handling" time="0.003" /><testcase classname="massgen.tests.test_claude_backend" name="test_claude_token_pricing" time="0.187" /><testcase classname="massgen.tests.test_claude_code" name="test_real_stream_with_tools" time="0.000"><skipped type="pytest.skip" message="integration test (enable with --run-integration or RUN_INTEGRATION=1)">/Users/admin/src/MassGen/massgen/tests/test_claude_code.py:19: integration test (enable with --run-integration or RUN_INTEGRATION=1)</skipped></testcase><testcase classname="massgen.tests.test_claude_code" name="test_with_workflow_tools" time="0.000"><skipped type="pytest.skip" message="integration test (enable with --run-integration or RUN_INTEGRATION=1)">/Users/admin/src/MassGen/massgen/tests/test_claude_code.py:156: integration test (enable with --run-integration or RUN_INTEGRATION=1)</skipped></testcase><testcase classname="massgen.tests.test_claude_code_context_sharing" name="test_orchestrator_initialization_with_context_sharing" time="0.006"><skipped type="pytest.xfail" message="Orchestrator missing context sharing methods (_agent_id_mapping, etc.); feature likely removed or not implemented. (.cursor/triage/clusters/cluster_3214aa51a1.md)" /></testcase><testcase classname="massgen.tests.test_claude_code_context_sharing" name="test_snapshot_saving" time="0.005"><skipped type="pytest.xfail" message="Orchestrator missing context sharing methods (_save_claude_code_snapshot); feature likely removed or not implemented. (.cursor/triage/clusters/cluster_3214aa51a1.md)" /></testcase><testcase classname="massgen.tests.test_claude_code_context_sharing" name="test_workspace_restoration_with_anonymization" time="0.003"><skipped type="pytest.xfail" message="Orchestrator missing context sharing methods (_restore_snapshots_to_workspace); feature likely removed or not implemented. (.cursor/triage/clusters/cluster_3214aa51a1.md)" /></testcase><testcase classname="massgen.tests.test_claude_code_context_sharing" name="test_save_all_snapshots" time="0.004"><skipped type="pytest.xfail" message="Orchestrator missing context sharing methods (_save_all_claude_code_snapshots); feature likely removed or not implemented. (.cursor/triage/clusters/cluster_3214aa51a1.md)" /></testcase><testcase classname="massgen.tests.test_claude_code_context_sharing" name="test_non_claude_code_agents_ignored" time="0.002"><skipped type="pytest.xfail" message="Orchestrator missing context sharing mappings (_agent_id_mapping); feature likely removed or not implemented. (.cursor/triage/clusters/cluster_3214aa51a1.md)" /></testcase><testcase classname="massgen.tests.test_claude_code_orchestrator" name="test_claude_code_with_orchestrator" time="0.000"><skipped type="pytest.skip" message="integration test (enable with --run-integration or RUN_INTEGRATION=1)">/Users/admin/src/MassGen/massgen/tests/test_claude_code_orchestrator.py:26: integration test (enable with --run-integration or RUN_INTEGRATION=1)</skipped></testcase><testcase classname="massgen.tests.test_claude_code_orchestrator" name="test_stateful_behavior" time="0.000" /><testcase classname="massgen.tests.test_cli_backends" name="test_cli_base_functionality" time="0.102" /><testcase classname="massgen.tests.test_cli_backends" name="test_claude_code_cli_command_building" time="0.000" /><testcase classname="massgen.tests.test_cli_backends" name="test_configuration_files" time="0.000" /><testcase classname="massgen.tests.test_cli_backends" name="test_end_to_end_mock" time="0.103" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_setup_code_based_tools_creates_directories" time="0.010" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_setup_code_based_tools_generates_tool_wrappers" time="0.005" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_setup_code_based_tools_generates_mcp_client" time="0.004" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_setup_code_based_tools_generates_servers_json" time="0.004" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_setup_code_based_tools_generates_servers_init" time="0.003" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_generated_server_init_imports" time="0.003" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_custom_tools_directory_created" time="0.003" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_extract_mcp_tool_schemas_organizes_by_server" time="0.001" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_extract_mcp_tool_schemas_strips_prefix" time="0.001" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_extract_mcp_tool_schemas_preserves_schemas" time="0.001" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_setup_code_based_tools_disabled_does_nothing" time="0.001" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_tool_code_writer_creates_complete_structure" time="0.002" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_code_generator_produces_importable_code" time="0.001" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_shared_tools_directory_generates_in_shared_location" time="0.004" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_shared_tools_directory_skips_regeneration" time="0.005" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_shared_tools_directory_adds_to_read_only_paths" time="0.004" /><testcase classname="massgen.tests.test_code_based_tools_integration.TestCodeBasedToolsIntegration" name="test_without_shared_tools_directory_uses_workspace" time="0.002" /><testcase classname="massgen.tests.test_code_execution.TestCodeExecutionBasics" name="test_simple_python_command" time="0.031" /><testcase classname="massgen.tests.test_code_execution.TestCodeExecutionBasics" name="test_python_script_execution" time="0.027" /><testcase classname="massgen.tests.test_code_execution.TestCodeExecutionBasics" name="test_command_with_error" time="0.026" /><testcase classname="massgen.tests.test_code_execution.TestCodeExecutionBasics" name="test_command_timeout" time="1.012" /><testcase classname="massgen.tests.test_code_execution.TestCodeExecutionBasics" name="test_working_directory" time="0.047" /><testcase classname="massgen.tests.test_code_execution.TestPathValidation" name="test_path_exists_validation" time="0.007" /><testcase classname="massgen.tests.test_code_execution.TestPathValidation" name="test_relative_path_resolution" time="0.028" /><testcase classname="massgen.tests.test_code_execution.TestCommandSanitization" name="test_dangerous_command_patterns" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestCommandSanitization" name="test_safe_commands_pass" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestSudoSanitization" name="test_sudo_blocked_by_default" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestSudoSanitization" name="test_sudo_allowed_when_enabled" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestSudoSanitization" name="test_other_dangerous_patterns_still_blocked_with_sudo" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestSudoSanitization" name="test_su_chown_chmod_blocked_without_sudo_flag" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestSudoSanitization" name="test_su_chown_chmod_allowed_with_sudo_flag" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestSudoSanitization" name="test_local_mode_blocks_sudo" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestSudoSanitization" name="test_docker_sudo_mode_allows_sudo" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestOutputHandling" name="test_stdout_capture" time="0.027" /><testcase classname="massgen.tests.test_code_execution.TestOutputHandling" name="test_stderr_capture" time="0.026" /><testcase classname="massgen.tests.test_code_execution.TestOutputHandling" name="test_large_output_handling" time="0.026" /><testcase classname="massgen.tests.test_code_execution.TestCrossPlatform" name="test_python_version_check" time="0.014" /><testcase classname="massgen.tests.test_code_execution.TestCrossPlatform" name="test_pip_install" time="0.025"><failure message="assert 1 == 0">self = &lt;massgen.tests.test_code_execution.TestCrossPlatform object at 0x122d482d0&gt;
tmp_path = PosixPath('/private/var/folders/s6/wh4j5vn56x5dd00v0v5h8h9h0000gp/T/pytest-of-admin/pytest-75/test_pip_install0')

    def test_pip_install(self, tmp_path):
        """Test that pip commands work."""
        # Just check pip version, don't actually install anything
        exit_code, stdout, stderr = run_command_directly(
            f"{sys.executable} -m pip --version",
            cwd=str(tmp_path),
        )
&gt;       assert exit_code == 0
E       assert 1 == 0

massgen/tests/test_code_execution.py:314: AssertionError</failure></testcase><testcase classname="massgen.tests.test_code_execution.TestAutoGeneratedFiles" name="test_pycache_deletion_allowed" time="0.001" /><testcase classname="massgen.tests.test_code_execution.TestAutoGeneratedFiles" name="test_pyc_file_deletion_allowed" time="0.001"><failure message="assert False">self = &lt;massgen.tests.test_code_execution.TestAutoGeneratedFiles object at 0x122d48550&gt;
tmp_path = PosixPath('/private/var/folders/s6/wh4j5vn56x5dd00v0v5h8h9h0000gp/T/pytest-of-admin/pytest-75/test_pyc_file_deletion_allowed0')

    def test_pyc_file_deletion_allowed(self, tmp_path):
        """Test that .pyc files can be deleted without reading."""
        from massgen.filesystem_manager._file_operation_tracker import (
            FileOperationTracker,
        )
    
        tracker = FileOperationTracker(enforce_read_before_delete=True)
    
        # Create a fake .pyc file
        pyc_file = tmp_path / "module.pyc"
        pyc_file.write_text("fake bytecode")
    
        # Should be deletable without reading
        can_delete, reason = tracker.can_delete(pyc_file)
&gt;       assert can_delete
E       assert False

massgen/tests/test_code_execution.py:354: AssertionError</failure></testcase><testcase classname="massgen.tests.test_code_execution.TestAutoGeneratedFiles" name="test_pytest_cache_deletion_allowed" time="0.001" /><testcase classname="massgen.tests.test_code_execution.TestAutoGeneratedFiles" name="test_regular_file_requires_read" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestAutoGeneratedFiles" name="test_directory_with_pycache_allowed" time="0.001" /><testcase classname="massgen.tests.test_code_execution.TestVirtualEnvironment" name="test_auto_detect_venv" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestVirtualEnvironment" name="test_no_venv_fallback" time="0.000" /><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_manager_initialization" time="0.001"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:475: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_container_creation" time="0.001"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:487: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_command_execution" time="0.000"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:509: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_container_persistence" time="0.000"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:537: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_workspace_mounting" time="0.000"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:570: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_container_isolation" time="0.000"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:613: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_resource_limits" time="0.000"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:647: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_network_isolation" time="0.000"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:674: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_command_timeout" time="0.000"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:702: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_context_path_mounting" time="0.000"><skipped type="pytest.skip" message="Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:733: Docker not available: Error while fetching server API version: ('Connection aborted.', FileNotFoundError(2, 'No such file or directory'))</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_sudo_enabled_image_selection" time="0.000"><skipped type="pytest.skip" message="docker test (enable with --run-docker or RUN_DOCKER=1)">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:783: docker test (enable with --run-docker or RUN_DOCKER=1)</skipped></testcase><testcase classname="massgen.tests.test_code_execution.TestDockerExecution" name="test_docker_sudo_functionality" time="0.000"><skipped type="pytest.skip" message="docker test (enable with --run-docker or RUN_DOCKER=1)">/Users/admin/src/MassGen/massgen/tests/test_code_execution.py:806: docker test (enable with --run-docker or RUN_DOCKER=1)</skipped></testcase><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_basic_structure" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_function_signature" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_docstring" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_complex_params" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_build_function_params_required_only" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_build_function_params_optional_only" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_build_function_params_mixed" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_json_type_to_python_type" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_get_default_value_string" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_get_default_value_number" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_get_default_value_boolean" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_get_default_value_none" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_build_docstring" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_build_args_dict_empty" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_build_args_dict_single_param" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_build_args_dict_multiple_params" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_server_init" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_server_init_single_tool" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_mcp_client" time="0.000"><failure message="assert 'asyncio.get_event_loop()' in '&quot;&quot;&quot;\nMCP Client for Tool Execution\n\nThis module handles MCP protocol communication for tool wrappers.\nIt\'s hidden...global _mcp_client\n    if _mcp_client is not None:\n        await _mcp_client.cleanup()\n        _mcp_client = None\n'">self = &lt;massgen.tests.test_code_generator.TestMCPToolCodeGenerator object at 0x122d5a0d0&gt;
generator = &lt;massgen.mcp_tools.code_generator.MCPToolCodeGenerator object at 0x124152170&gt;

    def test_generate_mcp_client(self, generator):
        """Test MCP client code generation."""
        code = generator.generate_mcp_client()
    
        # Verify imports
        assert "import asyncio" in code
        assert "import json" in code
        assert "from massgen.mcp_tools.client import MCPClient" in code
    
        # Verify server config loading
        assert "servers.json" in code
        assert "SERVERS = json.load(f)" in code
    
        # Verify client functions
        assert "async def _ensure_client()" in code
        assert "def call_mcp_tool(server: str, tool: str, arguments: Dict[str, Any])" in code
        assert "async def call_mcp_tool_async(server: str, tool: str, arguments: Dict[str, Any])" in code
    
        # Verify utility functions
        assert "def list_servers()" in code
        assert "def get_server_config(server: str)" in code
        assert "async def cleanup()" in code
    
        # Verify event loop handling
&gt;       assert "asyncio.get_event_loop()" in code
E       assert 'asyncio.get_event_loop()' in '"""\nMCP Client for Tool Execution\n\nThis module handles MCP protocol communication for tool wrappers.\nIt\'s hidden...global _mcp_client\n    if _mcp_client is not None:\n        await _mcp_client.cleanup()\n        _mcp_client = None\n'

massgen/tests/test_code_generator.py:339: AssertionError</failure></testcase><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tools_init" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_no_parameters" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_all_optional_params" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_array_and_object_types" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_preserves_description" time="0.000" /><testcase classname="massgen.tests.test_code_generator.TestMCPToolCodeGenerator" name="test_generate_tool_wrapper_cli_usage" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_openai_to_gemini_preserves_provider" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_copies_filesystem_cwd" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_updates_workspace_number" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_copies_compatible_tools" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_skips_incompatible_tools" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_skips_openai_reasoning_to_gemini" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_preserves_openai_reasoning_to_openai" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_skips_code_interpreter_openai_to_gemini" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_skips_code_execution_gemini_to_openai" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_copies_mcp_servers_when_supported" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_same_provider_copies_everything" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCloneAgent" name="test_clone_generates_skipped_settings_list" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestApplyPresetToAgent" name="test_apply_preset_generates_unique_workspace" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestApplyPresetToAgent" name="test_apply_preset_multiple_agents_unique_workspaces" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestApplyPresetToAgent" name="test_apply_preset_filesystem_enabled_for_preset" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestApplyPresetToAgent" name="test_apply_preset_respects_agent_index" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCrossProviderCompatibility" name="test_web_search_compatible_providers" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCrossProviderCompatibility" name="test_code_interpreter_only_openai_azure" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCrossProviderCompatibility" name="test_code_execution_only_claude_gemini" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCrossProviderCompatibility" name="test_filesystem_copied_across_all_providers" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestCrossProviderCompatibility" name="test_command_line_execution_mode_universal" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestWorkspaceUniqueness" name="test_three_agents_get_workspace1_2_3" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestWorkspaceUniqueness" name="test_clone_updates_workspace_for_target_agent" time="0.000" /><testcase classname="massgen.tests.test_config_builder.TestWorkspaceUniqueness" name="test_mixed_providers_all_unique_workspaces" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_valid_single_agent_config" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_valid_multi_agent_config" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_valid_config_with_orchestrator" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_valid_config_with_ui" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_v1_config_rejected" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_missing_agents_field" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_both_agents_and_agent" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_missing_agent_id" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_missing_backend" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_duplicate_agent_ids" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_missing_backend_type" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_missing_backend_model" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_unknown_backend_type" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_invalid_permission_mode" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_backend_capability_validation" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_invalid_display_type" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_invalid_voting_sensitivity" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_invalid_context_path_permission" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_warning_both_allowed_and_exclude_tools" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_no_warning_missing_system_message" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_no_warning_multi_agent_no_orchestrator" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_invalid_type_field_types" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_validate_file_not_found" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_validate_yaml_file" time="0.001" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_validate_json_file" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_validation_result_to_dict" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_validation_result_format_errors" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_validation_result_format_warnings" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_tool_filtering_validation" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_mcp_servers_validation" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestConfigValidator" name="test_complex_valid_config" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_v1_config_with_models_list" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_v1_config_with_model_configs" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_missing_both_agents_and_agent" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_typo_in_backend_type" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_wrong_case_backend_type" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_unsupported_feature_for_backend" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_boolean_as_string" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_number_as_string" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_invalid_display_type_typo" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_invalid_permission_mode" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_context_path_wrong_permission" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_negative_timeout" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_negative_max_restarts" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_agent_without_id" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_agent_without_backend" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_tools_list_with_non_strings" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_mcp_servers_wrong_type" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_invalid_voting_sensitivity" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_invalid_answer_novelty" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_v1_max_rounds" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_v1_consensus_threshold" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_v1_voting_enabled" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestCommonBadConfigs" name="test_v1_multiple_keywords" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestMemoryValidation" name="test_valid_memory_config" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestMemoryValidation" name="test_memory_enabled_wrong_type" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestMemoryValidation" name="test_memory_qdrant_invalid_mode" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestMemoryValidation" name="test_memory_compression_out_of_range" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestMemoryValidation" name="test_memory_retrieval_negative_limit" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestMemoryValidation" name="test_memory_qdrant_invalid_port" time="0.000" /><testcase classname="massgen.tests.test_config_validator.TestMemoryValidation" name="test_memory_llm_provider_wrong_type" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_conversation_memory_initialization" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_add_single_message" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_add_multiple_messages" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_duplicate_prevention" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_allow_duplicates" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_delete_by_index" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_delete_multiple_indices" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_delete_invalid_index" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_get_last_message" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_get_messages_by_role" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_get_messages_with_limit" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_truncate_to_size" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_clear_memory" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_state_dict_serialization" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_state_dict_strict_mode" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_add_none_message" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_add_invalid_message_type" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_retrieve_not_implemented" time="0.000" /><testcase classname="massgen.tests.test_conversation_memory" name="test_message_isolation" time="0.000" /><testcase classname="massgen.tests.test_custom_tools.TestToolManager" name="test_add_tool_function_direct" time="0.001" /><testcase classname="massgen.tests.test_custom_tools.TestToolManager" name="test_add_tool_with_string_name" time="0.001"><failure message="AssertionError: assert 'read_file_content' in {'custom_tool__read_file_content': RegisteredToolEntry(tool_name='custom_tool__read_file_content', category='default',...ation.'}}, preset_params={}, context_param_names=set(), extension_model=None, mcp_server_id=None, post_processor=None)}&#10; +  where {'custom_tool__read_file_content': RegisteredToolEntry(tool_name='custom_tool__read_file_content', category='default',...ation.'}}, preset_params={}, context_param_names=set(), extension_model=None, mcp_server_id=None, post_processor=None)} = &lt;massgen.tool._manager.ToolManager object at 0x123f7b290&gt;.registered_tools&#10; +    where &lt;massgen.tool._manager.ToolManager object at 0x123f7b290&gt; = &lt;massgen.tests.test_custom_tools.TestToolManager object at 0x1231a4b90&gt;.tool_manager">self = &lt;massgen.tests.test_custom_tools.TestToolManager object at 0x1231a4b90&gt;

    def test_add_tool_with_string_name(self):
        """Test adding a built-in tool by name."""
        # This should find built-in functions from the tool module
        try:
            self.tool_manager.add_tool_function(func="read_file_content")
&gt;           assert "read_file_content" in self.tool_manager.registered_tools
E           AssertionError: assert 'read_file_content' in {'custom_tool__read_file_content': RegisteredToolEntry(tool_name='custom_tool__read_file_content', category='default',...ation.'}}, preset_params={}, context_param_names=set(), extension_model=None, mcp_server_id=None, post_processor=None)}
E            +  where {'custom_tool__read_file_content': RegisteredToolEntry(tool_name='custom_tool__read_file_content', category='default',...ation.'}}, preset_params={}, context_param_names=set(), extension_model=None, mcp_server_id=None, post_processor=None)} = &lt;massgen.tool._manager.ToolManager object at 0x123f7b290&gt;.registered_tools
E            +    where &lt;massgen.tool._manager.ToolManager object at 0x123f7b290&gt; = &lt;massgen.tests.test_custom_tools.TestToolManager object at 0x1231a4b90&gt;.tool_manager

massgen/tests/test_custom_tools.py:117: AssertionError</failure></testcase><testcase classname="massgen.tests.test_custom_tools.TestToolManager" name="test_add_tool_with_path" time="0.001" /><testcase classname="massgen.tests.test_custom_tools.TestToolManager" name="test_fetch_tool_schemas" time="0.001" /><testcase classname="massgen.tests.test_custom_tools.TestToolManager" name="test_execute_tool" time="0.001"><failure message="assert 'The sum of 5 and 3 is 8' in &quot;ToolNotFound: No tool named 'calculate_sum' exists&quot;&#10; +  where &quot;ToolNotFound: No tool named 'calculate_sum' exists&quot; = TextContent(block_type='text', data=&quot;ToolNotFound: No tool named 'calculate_sum' exists&quot;).data">self = &lt;massgen.tests.test_custom_tools.TestToolManager object at 0x1231c79b0&gt;

    @pytest.mark.asyncio
    async def test_execute_tool(self):
        """Test executing a tool."""
        self.tool_manager.add_tool_function(func=calculate_sum)
    
        tool_request = {
            "name": "calculate_sum",
            "input": {"a": 5, "b": 3},
        }
    
        results = []
        async for result in self.tool_manager.execute_tool(tool_request):
            results.append(result)
    
        assert len(results) &gt; 0
        result = results[0]
        assert hasattr(result, "output_blocks")
&gt;       assert "The sum of 5 and 3 is 8" in result.output_blocks[0].data
E       assert 'The sum of 5 and 3 is 8' in "ToolNotFound: No tool named 'calculate_sum' exists"
E        +  where "ToolNotFound: No tool named 'calculate_sum' exists" = TextContent(block_type='text', data="ToolNotFound: No tool named 'calculate_sum' exists").data

massgen/tests/test_custom_tools.py:173: AssertionError</failure></testcase><testcase classname="massgen.tests.test_custom_tools.TestToolManager" name="test_execute_async_tool" time="0.001"><failure message="assert 'Weather in Tokyo: Rainy, 22°C' in &quot;ToolNotFound: No tool named 'async_weather_fetcher' exists&quot;&#10; +  where &quot;ToolNotFound: No tool named 'async_weather_fetcher' exists&quot; = TextContent(block_type='text', data=&quot;ToolNotFound: No tool named 'async_weather_fetcher' exists&quot;).data">self = &lt;massgen.tests.test_custom_tools.TestToolManager object at 0x12319d6a0&gt;

    @pytest.mark.asyncio
    async def test_execute_async_tool(self):
        """Test executing an async tool."""
        self.tool_manager.add_tool_function(func=async_weather_fetcher)
    
        tool_request = {
            "name": "async_weather_fetcher",
            "input": {"city": "Tokyo"},
        }
    
        results = []
        async for result in self.tool_manager.execute_tool(tool_request):
            results.append(result)
    
        assert len(results) &gt; 0
        result = results[0]
&gt;       assert "Weather in Tokyo: Rainy, 22°C" in result.output_blocks[0].data
E       assert 'Weather in Tokyo: Rainy, 22°C' in "ToolNotFound: No tool named 'async_weather_fetcher' exists"
E        +  where "ToolNotFound: No tool named 'async_weather_fetcher' exists" = TextContent(block_type='text', data="ToolNotFound: No tool named 'async_weather_fetcher' exists").data

massgen/tests/test_custom_tools.py:191: AssertionError</failure></testcase><testcase classname="massgen.tests.test_custom_tools.TestResponseBackendCustomTools" name="test_backend_initialization_with_custom_tools" time="0.001" /><testcase classname="massgen.tests.test_custom_tools.TestResponseBackendCustomTools" name="test_get_custom_tools_schemas" time="0.001" /><testcase classname="massgen.tests.test_custom_tools.TestResponseBackendCustomTools" name="test_execute_custom_tool" time="0.001"><failure message="TypeError: object async_generator can't be used in 'await' expression">self = &lt;massgen.tests.test_custom_tools.TestResponseBackendCustomTools object at 0x1231996e0&gt;

    @pytest.mark.asyncio
    async def test_execute_custom_tool(self):
        """Test executing a custom tool through the backend."""
        backend = ResponseBackend(
            api_key=self.api_key,
            custom_tools=[{"func": calculate_sum}],
        )
    
        call = {
            "name": "custom_tool__calculate_sum",
            "call_id": "test_call_1",
            "arguments": json.dumps({"a": 10, "b": 20}),
        }
    
&gt;       result = await backend._execute_custom_tool(call)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       TypeError: object async_generator can't be used in 'await' expression

massgen/tests/test_custom_tools.py:267: TypeError</failure></testcase><testcase classname="massgen.tests.test_custom_tools.TestResponseBackendCustomTools" name="test_custom_tool_categorization" time="0.001" /><testcase classname="massgen.tests.test_custom_tools.TestCustomToolsIntegration" name="test_custom_tool_execution_flow" time="0.001" /><testcase classname="massgen.tests.test_custom_tools.TestCustomToolsIntegration" name="test_custom_tool_error_handling" time="0.000" /><testcase classname="massgen.tests.test_custom_tools.TestCustomToolsIntegration" name="test_mixed_tools_categorization" time="0.001" /><testcase classname="massgen.tests.test_exclude_file_operation_mcps.TestExcludeFileOperationMCPs" name="test_filesystem_manager_with_exclude_flag_false" time="0.001" /><testcase classname="massgen.tests.test_exclude_file_operation_mcps.TestExcludeFileOperationMCPs" name="test_filesystem_manager_with_exclude_flag_true" time="0.000" /><testcase classname="massgen.tests.test_exclude_file_operation_mcps.TestExcludeFileOperationMCPs" name="test_inject_filesystem_mcp_excludes_filesystem_server" time="0.001" /><testcase classname="massgen.tests.test_exclude_file_operation_mcps.TestExcludeFileOperationMCPs" name="test_inject_filesystem_mcp_keeps_workspace_tools_with_media" time="0.001"><failure message="AssertionError: assert 'filesystem' not in ['filesystem', 'workspace_tools', 'command_line']">self = &lt;massgen.tests.test_exclude_file_operation_mcps.TestExcludeFileOperationMCPs object at 0x123199ba0&gt;
temp_workspace = {'temp_workspace_parent': '/var/folders/s6/wh4j5vn56x5dd00v0v5h8h9h0000gp/T/tmprxncg8ou/temp_workspaces', 'workspace': '/var/folders/s6/wh4j5vn56x5dd00v0v5h8h9h0000gp/T/tmprxncg8ou/workspace'}

    def test_inject_filesystem_mcp_keeps_workspace_tools_with_media(self, temp_workspace):
        """Test that workspace_tools MCP is kept when media generation is enabled."""
        manager = FilesystemManager(
            cwd=temp_workspace["workspace"],
            agent_temporary_workspace_parent=temp_workspace["temp_workspace_parent"],
            exclude_file_operation_mcps=True,
            enable_mcp_command_line=True,
            enable_image_generation=True,  # Enable media generation
        )
    
        # Create a mock backend config
        backend_config = {"mcp_servers": []}
    
        # Inject MCPs
        result_config = manager.inject_filesystem_mcp(backend_config)
    
        # Get server names
        server_names = [server["name"] for server in result_config["mcp_servers"]]
    
        # Verify filesystem MCP is NOT added
&gt;       assert "filesystem" not in server_names
E       AssertionError: assert 'filesystem' not in ['filesystem', 'workspace_tools', 'command_line']

massgen/tests/test_exclude_file_operation_mcps.py:128: AssertionError</failure></testcase><testcase classname="massgen.tests.test_exclude_file_operation_mcps.TestExcludeFileOperationMCPs" name="test_inject_filesystem_mcp_normal_behavior" time="0.001" /><testcase classname="massgen.tests.test_exclude_file_operation_mcps.TestExcludeFileOperationMCPs" name="test_workspace_tools_excludes_media_when_disabled" time="0.000" /><testcase classname="massgen.tests.test_exclude_file_operation_mcps.TestExcludeFileOperationMCPs" name="test_workspace_tools_keeps_media_when_enabled" time="0.000" /><testcase classname="massgen.tests.test_external_agent_backend" name="test_initialization_with_valid_adapter" time="0.000" /><testcase classname="massgen.tests.test_external_agent_backend" name="test_initialization_with_invalid_adapter" time="0.000" /><testcase classname="massgen.tests.test_external_agent_backend" name="test_adapter_type_case_insensitive" time="0.000" /><testcase classname="massgen.tests.test_external_agent_backend" name="test_stream_with_tools" time="0.023" /><testcase classname="massgen.tests.test_external_agent_backend" name="test_extract_adapter_config" time="0.000" /><testcase classname="massgen.tests.test_external_agent_backend" name="test_is_stateful_default" time="0.000" /><testcase classname="massgen.tests.test_external_agent_backend" name="test_clear_history" time="0.000" /><testcase classname="massgen.tests.test_external_agent_backend" name="test_reset_state" time="0.000" /><testcase classname="massgen.tests.test_final_presentation_fallback" name="test_final_presentation_fallback" time="0.003" /><testcase classname="massgen.tests.test_final_presentation_fallback" name="test_final_presentation_with_content" time="0.001" /><testcase classname="massgen.tests.test_final_presentation_fallback" name="test_no_stored_answer_fallback" time="0.002" /><testcase classname="massgen.tests.test_gemini_planning_mode" name="test_gemini_planning_mode" time="0.000" /><testcase classname="massgen.tests.test_gemini_planning_mode" name="test_gemini_mcp_tool_registration_blocking" time="0.000" /><testcase classname="massgen.tests.test_gemini_planning_mode" name="test_gemini_planning_mode_integration" time="0.000" /><testcase classname="massgen.tests.test_gemini_planning_mode" name="test_gemini_actual_planning_mode_logic" time="0.000" /><testcase classname="massgen.tests.test_gemini_planning_mode" name="test_gemini_planning_mode_vs_other_backends" time="0.000" /><testcase classname="massgen.tests.test_grok_backend" name="test_grok_basic" time="0.000" /><testcase classname="massgen.tests.test_grok_backend" name="test_grok_streaming" time="0.000" /><testcase classname="massgen.tests.test_grok_backend" name="test_grok_with_agent" time="0.000" /><testcase classname="massgen.tests.test_integration_simple" name="test_cli_import" time="0.000" /><testcase classname="massgen.tests.test_integration_simple" name="test_config_creation" time="0.080" /><testcase classname="massgen.tests.test_integration_simple" name="test_agent_config_import" time="0.000" /><testcase classname="massgen.tests.test_integration_simple" name="test_orchestrator_import" time="0.000" /><testcase classname="massgen.tests.test_integration_simple" name="test_backend_base_import" time="0.000" /><testcase classname="massgen.tests.test_integration_simple" name="test_frontend_import" time="0.000" /><testcase classname="massgen.tests.test_integration_simple" name="test_message_templates_import" time="0.000" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_irreversible_operation_enables_planning_mode" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_reversible_operation_disables_planning_mode" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_planning_mode_set_on_all_agents" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_error_defaults_to_safe_mode" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_analysis_uses_random_agent" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_mixed_responses_parsed_correctly" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_selective_blocking_multiple_tools" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_selective_blocking_with_whitespace" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_isolated_workspace_detection" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_no_isolated_workspace_detection" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_backend_selective_blocking_logic" time="0.000" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_chat_sets_blocked_tools_on_agents" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_empty_blocked_tools_list" time="0.001" /><testcase classname="massgen.tests.test_intelligent_planning_mode" name="test_case_insensitive_workspace_detection" time="0.001" /><testcase classname="massgen.tests.test_langgraph_lesson_planner.TestLangGraphLessonPlannerTool" name="test_basic_lesson_plan_creation" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_langgraph_lesson_planner.py:32: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_langgraph_lesson_planner.TestLangGraphLessonPlannerTool" name="test_lesson_plan_with_env_api_key" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_langgraph_lesson_planner.py:52: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_langgraph_lesson_planner.TestLangGraphLessonPlannerTool" name="test_missing_api_key_error" time="0.000"><failure message="TypeError: langgraph_lesson_planner() got an unexpected keyword argument 'topic'">self = &lt;massgen.tests.test_langgraph_lesson_planner.TestLangGraphLessonPlannerTool object at 0x1235b4e90&gt;

    @pytest.mark.asyncio
    async def test_missing_api_key_error(self):
        """Test error handling when API key is missing."""
        # Temporarily save and remove env var
        original_key = os.environ.get("OPENAI_API_KEY")
        if "OPENAI_API_KEY" in os.environ:
            del os.environ["OPENAI_API_KEY"]
    
        try:
&gt;           result = await langgraph_lesson_planner(topic="test topic")
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E           TypeError: langgraph_lesson_planner() got an unexpected keyword argument 'topic'

massgen/tests/test_langgraph_lesson_planner.py:71: TypeError</failure></testcase><testcase classname="massgen.tests.test_langgraph_lesson_planner.TestLangGraphLessonPlannerTool" name="test_different_topics" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_langgraph_lesson_planner.py:88: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_langgraph_lesson_planner.TestLangGraphLessonPlannerTool" name="test_concurrent_lesson_plan_creation" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_langgraph_lesson_planner.py:107: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_langgraph_lesson_planner.TestLangGraphToolIntegration" name="test_tool_function_signature" time="0.000"><failure message="AssertionError: assert False&#10; +  where False = &lt;function iscoroutinefunction at 0x109344720&gt;(langgraph_lesson_planner)&#10; +    where &lt;function iscoroutinefunction at 0x109344720&gt; = &lt;module 'inspect' from '/opt/homebrew/Cellar/python@3.13/3.13.11/Frameworks/Python.framework/Versions/3.13/lib/python3.13/inspect.py'&gt;.iscoroutinefunction">self = &lt;massgen.tests.test_langgraph_lesson_planner.TestLangGraphToolIntegration object at 0x1238a8690&gt;

    def test_tool_function_signature(self):
        """Test that the tool has the correct async signature."""
        import inspect
    
&gt;       assert inspect.iscoroutinefunction(langgraph_lesson_planner)
E       AssertionError: assert False
E        +  where False = &lt;function iscoroutinefunction at 0x109344720&gt;(langgraph_lesson_planner)
E        +    where &lt;function iscoroutinefunction at 0x109344720&gt; = &lt;module 'inspect' from '/opt/homebrew/Cellar/python@3.13/3.13.11/Frameworks/Python.framework/Versions/3.13/lib/python3.13/inspect.py'&gt;.iscoroutinefunction

massgen/tests/test_langgraph_lesson_planner.py:134: AssertionError</failure></testcase><testcase classname="massgen.tests.test_langgraph_lesson_planner.TestLangGraphToolIntegration" name="test_execution_result_structure" time="0.000"><skipped type="pytest.skip" message="OPENAI_API_KEY not set">/Users/admin/src/MassGen/massgen/tests/test_langgraph_lesson_planner.py:153: OPENAI_API_KEY not set</skipped></testcase><testcase classname="massgen.tests.test_langgraph_lesson_planner.TestLangGraphToolWithBackend" name="test_backend_registration" time="0.001"><failure message="AssertionError: assert 'langgraph_lesson_planner' in {'custom_tool__langgraph_lesson_planner'}&#10; +  where {'custom_tool__langgraph_lesson_planner'} = &lt;massgen.backend.response.ResponseBackend object at 0x12496bed0&gt;._custom_tool_names">self = &lt;massgen.tests.test_langgraph_lesson_planner.TestLangGraphToolWithBackend object at 0x1238a8910&gt;

    @pytest.mark.asyncio
    async def test_backend_registration(self):
        """Test registering LangGraph tool with ResponseBackend."""
        from massgen.backend.response import ResponseBackend
    
        api_key = os.getenv("OPENAI_API_KEY", "test-key")
    
        # Import the tool
        from massgen.tool._extraframework_agents.langgraph_lesson_planner_tool import (
            langgraph_lesson_planner,
        )
    
        # Register with backend
        backend = ResponseBackend(
            api_key=api_key,
            custom_tools=[
                {
                    "func": langgraph_lesson_planner,
                    "description": "Create a comprehensive lesson plan using LangGraph state graph",
                },
            ],
        )
    
        # Verify tool is registered
&gt;       assert "langgraph_lesson_planner" in backend._custom_tool_names
E       AssertionError: assert 'langgraph_lesson_planner' in {'custom_tool__langgraph_lesson_planner'}
E        +  where {'custom_tool__langgraph_lesson_planner'} = &lt;massgen.backend.response.ResponseBackend object at 0x12496bed0&gt;._custom_tool_names

massgen/tests/test_langgraph_lesson_planner.py:199: AssertionError</failure></testcase><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_calculate_cost_with_usage_dict" time="0.002" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_calculate_cost_with_usage_object" time="0.000" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_reasoning_tokens_handled" time="0.001" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_cached_tokens_discount" time="0.185" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_fallback_on_unknown_model" time="0.195" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_fallback_extraction_openai_format" time="0.203" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_fallback_extraction_anthropic_format" time="0.196" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_empty_usage_returns_zero" time="0.000" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMIntegration" name="test_none_usage_returns_zero" time="0.000" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMCaching" name="test_cache_is_populated" time="0.201" /><testcase classname="massgen.tests.test_litellm_integration.TestLiteLLMCaching" name="test_cache_has_models" time="0.195" /><testcase classname="massgen.tests.test_litellm_integration.TestProviderFormats" name="test_sglang_top_level_reasoning_tokens" time="0.001" /><testcase classname="massgen.tests.test_litellm_integration.TestProviderFormats" name="test_grok_reasoning_format" time="0.001" /><testcase classname="massgen.tests.test_litellm_integration.TestProviderFormats" name="test_openai_cached_tokens_format" time="0.002" /><testcase classname="massgen.tests.test_litellm_integration.TestProviderFormats" name="test_groq_usage_format" time="0.001" /><testcase classname="massgen.tests.test_litellm_integration.TestErrorHandling" name="test_malformed_usage_objects" time="0.000" /><testcase classname="massgen.tests.test_litellm_integration.TestErrorHandling" name="test_missing_nested_details" time="0.000" /><testcase classname="massgen.tests.test_mcp_blocking" name="test_mcp_blocking" time="0.001" /><testcase classname="massgen.tests.test_mcp_blocking" name="test_backend_inheritance" time="0.001" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_npx_package" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_npx_without_y_flag" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_uv_package" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_uv_run_package" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_docker_image" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_docker_with_flags" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_python_module" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_empty_config" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_no_args" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestExtractPackageInfo" name="test_unknown_command" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestGetMCPServerDescriptions" name="test_uses_inline_description_fallback" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestGetMCPServerDescriptions" name="test_uses_fallback_descriptions" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestGetMCPServerDescriptions" name="test_generates_generic_description" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestGetMCPServerDescriptions" name="test_fetches_from_registry" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestMCPRegistryClient" name="test_cache_key_generation" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestMCPRegistryClient" name="test_different_packages_different_keys" time="0.000" /><testcase classname="massgen.tests.test_mcp_registry_client.TestMCPRegistryClient" name="test_find_server_by_package_match" time="0.001" /><testcase classname="massgen.tests.test_mcp_registry_client.TestMCPRegistryClient" name="test_find_server_not_found" time="0.001" /><testcase classname="massgen.tests.test_message_context_building" name="test_turn1_context" time="0.000"><skipped type="pytest.xfail" message="MessageTemplates API drift (missing evaluation_system_message); fix template or update tests (.cursor/triage/tasks/cluster_9f91c21fe7.md)" /></testcase><testcase classname="massgen.tests.test_message_context_building" name="test_turn2_context" time="0.000"><skipped type="pytest.xfail" message="MessageTemplates API drift (missing evaluation_system_message); fix template or update tests (.cursor/triage/tasks/cluster_9f91c21fe7.md)" /></testcase><testcase classname="massgen.tests.test_message_context_building" name="test_turn3_context" time="0.000"><skipped type="pytest.xfail" message="MessageTemplates API drift (missing evaluation_system_message); fix template or update tests (.cursor/triage/tasks/cluster_9f91c21fe7.md)" /></testcase><testcase classname="massgen.tests.test_message_context_building" name="test_context_comparison" time="0.000"><skipped type="pytest.xfail" message="MessageTemplates API drift (missing evaluation_system_message); fix template or update tests (.cursor/triage/tasks/cluster_9f91c21fe7.md)" /></testcase><testcase classname="massgen.tests.test_multimodal_size_limits.TestImageSizeLimits" name="test_image_within_limits" time="0.009"><skipped type="pytest.xfail" message="Multimodal limits assertions failing; investigate size limit logic or fixtures (.cursor/triage/tasks/cluster_72c1f34cf2.md)" /></testcase><testcase classname="massgen.tests.test_multimodal_size_limits.TestImageSizeLimits" name="test_image_dimension_limit" time="0.034"><skipped type="pytest.xfail" message="Multimodal limits assertions failing; investigate size limit logic or fixtures (.cursor/triage/tasks/cluster_72c1f34cf2.md)" /></testcase><testcase classname="massgen.tests.test_multimodal_size_limits.TestImageSizeLimits" name="test_image_dimension_calculation" time="0.000" /><testcase classname="massgen.tests.test_multimodal_size_limits.TestVideoFrameLimits" name="test_video_with_large_frames" time="0.328"><skipped type="pytest.xfail" message="Multimodal limits assertions failing; investigate size limit logic or fixtures (.cursor/triage/tasks/cluster_72c1f34cf2.md)" /></testcase><testcase classname="massgen.tests.test_multimodal_size_limits.TestVideoFrameLimits" name="test_video_with_small_frames" time="0.008"><skipped type="pytest.xfail" message="Multimodal limits assertions failing; investigate size limit logic or fixtures (.cursor/triage/tasks/cluster_72c1f34cf2.md)" /></testcase><testcase classname="massgen.tests.test_multimodal_size_limits.TestAudioSizeLimits" name="test_audio_within_size_limit" time="0.002"><skipped type="pytest.xfail" message="Multimodal limits assertions failing; investigate size limit logic or fixtures (.cursor/triage/tasks/cluster_72c1f34cf2.md)" /></testcase><testcase classname="massgen.tests.test_multimodal_size_limits.TestAudioSizeLimits" name="test_audio_exceeds_size_limit" time="0.095"><failure message="AssertionError: assert 'too large' in 'openai api key not found. please set openai_api_key in .env file or environment variable.'&#10; +  where 'openai api key not found. please set openai_api_key in .env file or environment variable.' = &lt;built-in method lower of str object at 0x124fb5590&gt;()&#10; +    where &lt;built-in method lower of str object at 0x124fb5590&gt; = 'OpenAI API key not found. Please set OPENAI_API_KEY in .env file or environment variable.'.lower">self = &lt;massgen.tests.test_multimodal_size_limits.TestAudioSizeLimits object at 0x1238aaad0&gt;
temp_dir = PosixPath('/var/folders/s6/wh4j5vn56x5dd00v0v5h8h9h0000gp/T/tmpmszd1csq')

    @pytest.mark.asyncio
    async def test_audio_exceeds_size_limit(self, temp_dir):
        """Test that audio files exceeding 25MB limit are rejected."""
        from massgen.tool._multimodal_tools.understand_audio import understand_audio
    
        # Create a large audio file (~30MB)
        audio_path = temp_dir / "large_audio.wav"
        self._create_large_audio(audio_path, target_size_mb=30)
    
        file_size = audio_path.stat().st_size
        assert file_size &gt; 25 * 1024 * 1024, f"Test audio should exceed 25MB, got {file_size / 1024 / 1024:.1f}MB"
    
        # This should fail validation before calling OpenAI
        result = await understand_audio([str(audio_path)])
    
        # Check that it failed due to size limit
        assert result.output_blocks is not None
        import json
    
        result_data = json.loads(result.output_blocks[0].data)
    
        print("\n" + "=" * 80)
        print(f"TEST: Audio Exceeds Size Limit ({file_size/1024/1024:.1f}MB &gt; 25MB)")
        print("=" * 80)
        print(json.dumps(result_data, indent=2))
        print("=" * 80 + "\n")
    
        assert result_data["success"] is False
&gt;       assert "too large" in result_data["error"].lower()
E       AssertionError: assert 'too large' in 'openai api key not found. please set openai_api_key in .env file or environment variable.'
E        +  where 'openai api key not found. please set openai_api_key in .env file or environment variable.' = &lt;built-in method lower of str object at 0x124fb5590&gt;()
E        +    where &lt;built-in method lower of str object at 0x124fb5590&gt; = 'OpenAI API key not found. Please set OPENAI_API_KEY in .env file or environment variable.'.lower

massgen/tests/test_multimodal_size_limits.py:383: AssertionError</failure></testcase><testcase classname="massgen.tests.test_multimodal_size_limits.TestAudioSizeLimits" name="test_audio_size_check" time="0.003" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_coordination_config_restart_params" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_agent_config_debug_final_answer" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_post_evaluation_toolkit_import" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_post_evaluation_tools_function" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_submit_tool_schema" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_restart_orchestration_tool_schema" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_message_templates_post_evaluation" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_orchestrator_restart_state" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_orchestrator_post_evaluate_method" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_orchestrator_handle_restart_method" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_handle_restart_resets_state" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_base_display_restart_methods" time="0.000" /><testcase classname="massgen.tests.test_orchestration_restart" name="test_post_evaluation_tools_api_formats" time="0.000" /><testcase classname="massgen.tests.test_orchestrator_final_presentation" name="test_orchestrator_import" time="0.000" /><testcase classname="massgen.tests.test_orchestrator_final_presentation" name="test_get_final_presentation_method" time="0.000" /><testcase classname="massgen.tests.test_orchestrator_final_presentation" name="test_stream_chunk_import" time="0.000" /><testcase classname="massgen.tests.test_orchestrator_final_presentation" name="test_message_templates_import" time="0.000" /><testcase classname="massgen.tests.test_orchestrator_final_presentation" name="test_orchestrator_initialization" time="0.000" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorSharedConversationMemory" name="test_orchestrator_with_shared_conversation_memory" time="0.002" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorSharedConversationMemory" name="test_shared_memory_injection_to_agents" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorSharedConversationMemory" name="test_agent_contributions_recorded_to_shared_memory" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorSharedConversationMemory" name="test_multiple_agents_share_same_memory" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorSharedConversationMemory" name="test_shared_memory_accumulates_over_time" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorSharedPersistentMemory" name="test_orchestrator_with_shared_persistent_memory" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorSharedPersistentMemory" name="test_persistent_memory_retrieval_for_agents" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorSharedPersistentMemory" name="test_persistent_memory_recording" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorBothMemories" name="test_orchestrator_with_both_shared_memories" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorBothMemories" name="test_both_memories_used_together" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestOrchestratorBothMemories" name="test_recording_to_both_memories" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestSharedMemoryErrorHandling" name="test_orchestrator_without_shared_memory" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestSharedMemoryErrorHandling" name="test_memory_failure_doesnt_crash_orchestrator" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestSharedMemoryErrorHandling" name="test_persistent_memory_not_implemented_handled" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestCrossAgentMemoryVisibility" name="test_agent_can_see_other_agents_contributions" time="0.001" /><testcase classname="massgen.tests.test_orchestrator_memory.TestCrossAgentMemoryVisibility" name="test_memory_shows_agent_attribution" time="0.001" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_mcp_relative_paths" time="0.561" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_is_write_tool" time="0.001" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_validate_write_tool" time="0.003" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_validate_command_tool" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_validate_execute_command_tool" time="0.003" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_pre_tool_use_hook" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_context_write_access_toggle" time="0.001" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_extract_file_from_command" time="0.001" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_workspace_tools" time="0.004" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_default_exclusions" time="0.005" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_path_priority_resolution" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_workspace_tools_server_path_validation" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_file_context_paths" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_delete_operations" time="0.001" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_permission_path_root_protection" time="0.003" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_protected_paths" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_delete_file_real_workspace_scenario" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_compare_tools" time="0.001" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_file_operation_tracker" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_read_before_delete_tracking" time="0.002" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_delete_validation_with_read_requirement" time="0.001" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_batch_delete_with_read_requirement" time="0.003" /><testcase classname="massgen.tests.test_path_permission_manager" name="test_read_before_delete_disabled" time="0.002" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryInitialization" name="test_initialization_without_identifiers_fails" time="0.227" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryInitialization" name="test_initialization_without_backends_fails" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryInitialization" name="test_initialization_with_agent_name" time="0.008" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryInitialization" name="test_initialization_with_all_identifiers" time="0.008" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_record_messages" time="0.002" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_retrieve_memories" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_retrieve_with_message_dict" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_retrieve_with_message_list" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_save_to_memory_tool" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_save_to_memory_error_handling" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_recall_from_memory_tool" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_recall_from_memory_with_limit" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_recall_from_memory_error_handling" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_record_empty_messages" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryMocked" name="test_retrieve_empty_query" time="0.001" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryIntegration" name="test_full_memory_workflow" time="0.012"><skipped type="pytest.skip" message="Integration test skipped: Error generating embedding with MassGen backend: object MagicMock can't be used in 'await' expression">/Users/admin/src/MassGen/massgen/tests/test_persistent_memory.py:354: Integration test skipped: Error generating embedding with MassGen backend: object MagicMock can't be used in 'await' expression</skipped></testcase><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryIntegration" name="test_memory_with_multiple_identifiers" time="0.012" /><testcase classname="massgen.tests.test_persistent_memory.TestPersistentMemoryBase" name="test_base_class_methods" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_simple_linear_workflow" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_parallel_workflow" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_dynamic_task_addition" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_complex_dependency_graph" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_task_editing_during_workflow" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_task_deletion_during_workflow" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_mixed_dependency_format_workflow" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_workflow_with_blocked_status" time="0.000" /><testcase classname="massgen.tests.test_planning_integration.TestPlanningWorkflows" name="test_serialization_during_workflow" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTask" name="test_task_creation" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTask" name="test_task_with_dependencies" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTask" name="test_task_serialization" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_plan_creation" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_add_task_simple" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_add_task_with_dependencies" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_add_task_invalid_dependency" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_add_task_duplicate_id" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_get_task" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_can_start_task_no_dependencies" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_can_start_task_with_completed_dependencies" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_can_start_task_with_incomplete_dependencies" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_get_ready_tasks" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_get_blocked_tasks" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_get_blocking_tasks" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_update_task_status" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_update_task_status_to_completed" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_update_task_status_unblocks_dependent_tasks" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_update_task_status_nonexistent_task" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_edit_task" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_edit_task_nonexistent" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_delete_task" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_delete_task_with_dependents" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_delete_task_nonexistent" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_validate_dependencies_simple" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_validate_dependencies_index_based" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_validate_dependencies_invalid_index" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_validate_dependencies_forward_reference" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_validate_dependencies_self_reference" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_validate_dependencies_nonexistent_id" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_circular_dependency_detection" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlan" name="test_plan_serialization" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlanComplexScenarios" name="test_parallel_tasks" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlanComplexScenarios" name="test_diamond_dependency" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestTaskPlanComplexScenarios" name="test_long_chain" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestMCPServerIntegration" name="test_create_task_plan_simple" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestMCPServerIntegration" name="test_resolve_dependency_references_index_based" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestMCPServerIntegration" name="test_resolve_dependency_references_mixed" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestMCPServerIntegration" name="test_resolve_dependency_references_invalid_index" time="0.000" /><testcase classname="massgen.tests.test_planning_tools.TestMCPServerIntegration" name="test_resolve_dependency_references_forward_reference" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_default" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_with_num_agents" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_with_single_model" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_with_multiple_models" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_with_explicit_backends" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_with_docker" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_without_docker" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_with_context_path" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_auto_detects_backend" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_slash_format" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_slash_format_mixed" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_slash_format_single_model" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_slash_format_cerebras" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_base_url_auto_fill" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestBuildConfig" name="test_build_config_base_url_qwen" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestLiteLLMProvider" name="test_litellm_available" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestLiteLLMProvider" name="test_register_with_litellm" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestLiteLLMProvider" name="test_register_idempotent" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestLiteLLMProvider" name="test_massgen_llm_class_exists" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestLiteLLMProvider" name="test_massgen_llm_instantiation" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestModelStringParsing" name="test_parse_model_build" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestModelStringParsing" name="test_parse_model_single_agent" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestModelStringParsing" name="test_parse_model_config_path" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestModelStringParsing" name="test_parse_model_example_config" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestModelStringParsing" name="test_parse_model_various_examples" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestQueryExtraction" name="test_extract_query_simple" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestQueryExtraction" name="test_extract_query_last_user_message" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestQueryExtraction" name="test_extract_query_multimodal_content" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestQueryExtraction" name="test_extract_query_empty_messages" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestQueryExtraction" name="test_extract_query_no_user_message" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestRunFunctionSignature" name="test_run_function_exists" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestRunFunctionSignature" name="test_run_is_async" time="0.000" /><testcase classname="massgen.tests.test_programmatic_api.TestRunFunctionIntegration" name="test_run_with_single_model" time="0.000"><skipped type="pytest.skip" message="expensive test (enable with --run-expensive or RUN_EXPENSIVE=1)">/Users/admin/src/MassGen/massgen/tests/test_programmatic_api.py:396: expensive test (enable with --run-expensive or RUN_EXPENSIVE=1)</skipped></testcase><testcase classname="massgen.tests.test_programmatic_api.TestRunFunctionIntegration" name="test_run_with_models_list" time="0.000"><skipped type="pytest.skip" message="expensive test (enable with --run-expensive or RUN_EXPENSIVE=1)">/Users/admin/src/MassGen/massgen/tests/test_programmatic_api.py:407: expensive test (enable with --run-expensive or RUN_EXPENSIVE=1)</skipped></testcase><testcase classname="massgen.tests.test_rate_limiter" name="test_shared_limiter_instances" time="0.000" /><testcase classname="massgen.tests.test_rate_limiter" name="test_rpm_limit_waits_without_real_sleep" time="0.000" /><testcase classname="massgen.tests.test_rich_terminal_display" name="test_rich_availability" time="0.000" /><testcase classname="massgen.tests.test_rich_terminal_display" name="test_rich_display_basic" time="0.001" /><testcase classname="massgen.tests.test_rich_terminal_display" name="test_rich_display_coordination" time="0.000" /><testcase classname="massgen.tests.test_rich_terminal_display" name="test_rich_convenience_function" time="0.000" /><testcase classname="massgen.tests.test_rich_terminal_display" name="test_rich_fallback" time="0.000" /><testcase classname="massgen.tests.test_rich_terminal_display" name="test_rich_themes" time="0.001" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_create_registry" time="0.000" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_register_session" time="0.000" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_update_existing_session" time="0.000" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_complete_session" time="0.000" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_list_sessions" time="0.001" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_list_sessions_by_status" time="0.001" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_session_exists" time="0.000" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_delete_session" time="0.000" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_format_session_list_empty" time="0.000" /><testcase classname="massgen.tests.test_session_registry.TestSessionRegistry" name="test_format_session_list_with_sessions" time="0.000" /><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_vhs_installed" time="0.009"><skipped type="pytest.xfail" message="Requires external VHS binary; classify/mark appropriately or add graceful skip when not installed (.cursor/triage/tasks/cluster_20d8cab08a.md)" /></testcase><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_vhs_check_function" time="0.012" /><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_vhs_tape_creation" time="0.001" /><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_tool_without_vhs" time="0.001" /><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_invalid_config_path" time="0.000" /><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_invalid_output_format" time="0.001" /><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_simple_recording" time="0.000"><skipped type="pytest.skip" message="VHS not installed - install with: brew install vhs">/Users/admin/src/MassGen/massgen/tests/test_terminal_evaluation.py:187: VHS not installed - install with: brew install vhs</skipped></testcase><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_gif_format" time="0.000"><skipped type="pytest.skip" message="VHS not installed - install with: brew install vhs">/Users/admin/src/MassGen/massgen/tests/test_terminal_evaluation.py:238: VHS not installed - install with: brew install vhs</skipped></testcase><testcase classname="massgen.tests.test_terminal_evaluation.TestTerminalEvaluation" name="test_path_validation" time="0.001" /><testcase classname="massgen.tests.test_terminal_evaluation.TestToolIntegration" name="test_tool_returns_execution_result" time="0.001" /><testcase classname="massgen.tests.test_terminal_evaluation.TestToolIntegration" name="test_tool_workflow_with_understand_video" time="0.001" /><testcase classname="massgen.tests.test_timeout" name="test_orchestrator_timeout" time="0.000" /><testcase classname="massgen.tests.test_tools" name="test_tool_manager" time="0.002" /><testcase classname="massgen.tests.test_v3_simple" name="test_single_agent" time="0.000" /><testcase classname="massgen.tests.test_v3_simple" name="test_orchestrator_single" time="0.000" /><testcase classname="massgen.tests.test_v3_simple" name="test_agent_status" time="0.000" /><testcase classname="massgen.tests.test_v3_simple" name="test_conversation_history" time="0.000" /><testcase classname="massgen.tests.test_v3_three_agents" name="test_three_agents_coordination" time="0.000" /><testcase classname="massgen.tests.test_v3_three_agents" name="test_three_agents_simple" time="0.000" /><testcase classname="massgen.tests.test_v3_three_agents" name="test_three_agents_consensus" time="0.000" /><testcase classname="massgen.tests.test_v3_two_agents" name="test_two_agents_coordination" time="0.000" /><testcase classname="massgen.tests.test_v3_two_agents" name="test_two_agents_simple" time="0.001" /></testsuite></testsuites>